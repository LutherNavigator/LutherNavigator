<link rel="stylesheet" type="text/css" href="/css/profile.css" />
<div class="container">
  <div class="mt-5">
    <div class="profile-summary clear-card mb-5">
      <img
        class="image-circle mb-2"
        id="user-image"
        height="200px"
        src="/image/user/{{userID}}"
        alt="User image"
      />
      <h2 class="centered mb-1">{{ firstname }} {{ lastname }}</h2>
      <h5 class="centered mb-1">{{ email }}</h5>
      <h6 class="centered mb-1">{{ numPosts }}</h6>
      <small class="centered"
        >Joined <span class="timestamp-date">{{ joinTime }}</span></small
      >
    </div>
    {{#if error}}
    <div class="alert alert-danger" role="alert">{{ error }}</div>
    {{/if}}

    <div id="your-posts" class="clear-card mb-5">
      <h3 class="posts">Your posts</h3>
      {{#if hasPosts}}
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Location</th>
            <th scope="col">Program</th>
            <th scope="col">Description</th>
            <th scope="col">Approved</th>
          </tr>
        </thead>
        <tbody>
          {{#each posts}}
          <tr onclick="window.location.href = '/post/{{this.id}}';">
            <td>{{ this.location }}</td>
            <td>{{ this.program }}</td>
            <td>{{ this.threeWords }}</td>
            <td>
              {{#if this.approved}}
              <i class="fas fa-check"></i>
              {{/if}}
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
      {{else}}
      <span>You have yet to create a post.</span>
      {{/if}}
    </div>

    <div class="clear-card mb-5">
      <form method="POST" enctype="multipart/form-data">
        <h3>Set image</h3>
        <div class="row">
          <div class="form-group col-12">
            <label for="imageDiv">Image</label>
            <div class="custom-file" id="imageDiv">
              <input
                type="file"
                class="custom-file-input"
                id="image"
                name="image"
                accept=".jpg, .jpeg, .png"
                required
              />
              <label class="custom-file-label" for="image">Choose file</label>
            </div>
          </div>
        </div>
        <button
          type="submit"
          class="btn btn-primary mb-3"
          formaction="/profile/setImage"
        >
          Set image
        </button>
      </form>
    </div>

    <div class="clear-card mb-5">
      <form method="POST">
        <h3>Change password</h3>
        <div class="row">
          <div class="form-group col-12 col-md-4">
            <label for="currentPassword">Current password</label>
            <input
              type="password"
              class="form-control"
              id="currentPassword"
              name="currentPassword"
              maxlength="128"
              required
            />
          </div>
          <div class="form-group col-12 col-md-4">
            <label for="newPassword">New password</label>
            <input
              type="password"
              class="form-control"
              id="newPassword"
              name="newPassword"
              maxlength="128"
              required
            />
          </div>
          <div class="form-group col-12 col-md-4">
            <label for="confirmNewPassword">Confirm new password</label>
            <input
              type="password"
              class="form-control"
              id="confirmNewPassword"
              name="confirmNewPassword"
              maxlength="128"
              required
            />
          </div>
        </div>
        <button
          type="submit"
          class="btn btn-primary"
          formaction="/profile/changePassword"
        >
          Change password
        </button>
      </form>
    </div>
  </div>
</div>
